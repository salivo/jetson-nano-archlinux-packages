# Maintainer: Andrii Salivon <andrijsalivon@plajta.eu>
pkgname=nvidia-l4t-core
pkgver=32.7.6
pkgrel=1
pkgdesc="Core libraries for AArch64 Jetson Nano"
arch=('aarch64')
url="https://repo.download.nvidia.com/jetson"
license=('unknown')

provides=("${pkgname}")

sha256sums=('61ada8308bd38fe6fe1793b658c83c3ef3dcc057a0d9e080dc0336e61be683c2')
            
source=("https://repo.download.nvidia.com/jetson/t210/pool/main/n/nvidia-l4t-core/nvidia-l4t-core_32.7.6-20241104234540_arm64.deb")

prepare() {
  cd "$srcdir"
  for deb in "${srcdir}"/*.deb; do
    ar x "$deb"
    tar xf data.tar.*
    rm data.tar.* control.tar.* debian-binary
  done
}

package() {
  install -d "${pkgdir}/usr/lib/"
  cp -a "${srcdir}"/usr/lib/aarch64-linux-gnu/* "${pkgdir}/usr/lib/"
  
  install -d "${pkgdir}/usr/share/doc/"
  cp -a "${srcdir}"/usr/share/doc/* "${pkgdir}/usr/share/doc/"

  install -d "${pkgdir}/usr/bin/"
  install -m 644 "${srcdir}"/usr/sbin/nvphsd "${pkgdir}"/usr/bin/nvphs

  install -d "${pkgdir}/etc/ld.so.conf.d"
  install -m 644 "${srcdir}"/etc/ld.so.conf.d/nvidia-tegra.conf "${pkgdir}"/etc/ld.so.conf.d/nvidia-tegra.conf

  install -m 644 "${srcdir}"/etc/nv_tegra_release "${pkgdir}"/etc/nv_tegra_release
}
